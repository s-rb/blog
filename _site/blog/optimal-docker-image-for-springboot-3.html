<!DOCTYPE html><html><head><head> <!-- Include Meta Tags Here --><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="viewport" content="width=device-width, height=device-height, initial-scale=1 user-scalable=no, shrink-to-fit=no"><meta content='#000000' name='theme-color'/><meta name="keywords" content="Site, Blog, Portfolio, CV, Java, Engineer, Developer"><title>Roman Surkoff | The optimal Docker image for Spring Boot. Part 3</title><!-- Open Graph general (Facebook, Pinterest & Google+) --><meta name="og:title" content="Roman Surkoff | The optimal Docker image for Spring Boot. Part 3"><meta name="og:description" content="Jib is a Google tool that simplifies building Docker images without Docker, optimizing image layers and supporting direct registry deployment."><meta name="og:image" content="/assets/images/posts/2024/00009-0.jpeg"><meta name="og:image:alt" content="Roman Surkoff | The optimal Docker image for Spring Boot. Part 3"><meta name="og:url" content="http://localhost:4000/blog/optimal-docker-image-for-springboot-3"><meta name="article:author" content="https://www.facebook.com/"><meta name="og:site_name" content="Roman Surkoff | The optimal Docker image for Spring Boot. Part 3"><meta name="og:type" content="website"> <!-- Twitter --><meta property="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Roman Surkoff | The optimal Docker image for Spring Boot. Part 3"><meta name="twitter:description" content="Jib is a Google tool that simplifies building Docker images without Docker, optimizing image layers and supporting direct registry deployment."><meta name="twitter:site" content="@"><meta name="twitter:creator" content="@"><meta name="twitter:image:src" content="/assets/images/posts/2024/00009-0.jpeg"> <!-- Search Engine --><meta name="description" content="Jib is a Google tool that simplifies building Docker images without Docker, optimizing image layers and supporting direct registry deployment."><meta name="image" content="/assets/images/posts/2024/00009-0.jpeg"> <!-- Schema.org for Google --><meta itemprop="name" content="Roman Surkoff | The optimal Docker image for Spring Boot. Part 3"><meta name="author" content="Roman Surkoff"/><meta itemprop="description" content="Jib is a Google tool that simplifies building Docker images without Docker, optimizing image layers and supporting direct registry deployment."><meta itemprop="image" content="/assets/images/posts/2024/00009-0.jpeg"> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=/"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', '/'); </script><title>Roman Surkoff</title><link rel="stylesheet" href="/assets/css/style.css"> <script src="https://kit.fontawesome.com/6a97161b76.js" crossorigin="anonymous"></script><link rel="shortcut icon" href="http://localhost:4000/assets/images/logo.png" type="image/x-icon"></head></head><body><nav class="navbar is-black is-fixed-top" role="navigation" aria-label="main navigation" id="navbar"><div class="container"> <!-- logo or branding image on left side --><div class="navbar-brand"> <a class="navbar-item" href="http://localhost:4000/"> <strong>Roman Surkoff</strong> </a><div class="navbar-burger" data-target="navbar-menu"> <span></span> <span></span> <span></span></div></div><!-- children of navbar-menu must be navbar-start and/or navbar-end --><div class="navbar-menu has-background-black" id="navbar-menu"> <!-- navbar items | left side --> <!--<div class="navbar-start"></div>--> <!-- navbar items | right side --><div class="navbar-end"> <a class="navbar-item " href="http://localhost:4000/">HOME</a> <a class="navbar-item" href="http://localhost:4000/#summary">SUMMARY</a> <a class="navbar-item" href="http://localhost:4000/#contact">CONTACT</a> <a class="navbar-item " href="http://localhost:4000/blog">BLOG</a><div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link"> MORE </a><div class="navbar-dropdown has-background-black is-left"> <a href="http://localhost:4000/about" class="navbar-item has-text-grey-light "> About me </a> <a href="http://localhost:4000/cv" class="navbar-item has-text-grey-light "> CV </a> <a href="http://localhost:4000/project" class="navbar-item has-text-grey-light "> Projects </a> <a href="http://localhost:4000/tech-stack" class="navbar-item has-text-grey-light "> Tech stack </a> <!--<hr class="navbar-divider"> <a class="navbar-item"> Report an issue </a> --></div></div></div></div></div></nav><!-- Bulma Navbar JS --> <script> document.addEventListener('DOMContentLoaded', function () { /* Get all "navbar-burger" elements */ var $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0); /* Check if there are any navbar burgers */ if ($navbarBurgers.length > 0) { /* Add a click event on each of them */ $navbarBurgers.forEach(function ($el) { $el.addEventListener('click', function () { /* Get the target from the "data-target" attribute */ var target = $el.dataset.target; var $target = document.getElementById(target); /* Toggle the class on both the "navbar-burger" and the "navbar-menu" */ $el.classList.toggle('is-active'); $target.classList.toggle('is-active'); }); }); } }); </script><section class="hero is-fullheight has-text-centered" id="post"><div class="hero-body"><div class="container"> <a href="/blog/optimal-docker-image-for-springboot-3" class="has-text-black" id="title"><h1 class="title has-text-centered is-2 has-text-weight-semibold">The optimal Docker image for Spring Boot. Part 3</h1></a><hr class="has-background-black"><div class="columns is-variable is-5"><div class="column is-6"><figure class="image is-16by9 has-shadow"> <img src="/assets/images/posts/2024/00009-0.jpeg" alt="" id="post-image"></figure></div><div class="subtitle column is-5 has-text-left-desktop has-text-left-fullhd has-text-left-tablet has-text-center-mobile"><p id="description" class="content is-small has-text-weight-medium is-uppercase">Jib is a Google tool that simplifies building Docker images without Docker, optimizing image layers and supporting direct registry deployment.</p><p class="subtitle is-6 is-uppercase has-text-weight-normal has-text-black-ter">Published on <b>October 16, 2024</b> by <a href="`https://github.com/s-rb" target="_blank"><b class="has-text-link"><u>Roman Surkoff</u></b> </a></p><p class="subtitle is-uppercase"> <i class="fas fa-tags"></i> <span class="tag is-link">springboot</span> <span class="tag is-link">docker</span> <span class="tag is-link">optimization</span> <span class="tag is-link">image</span> <span class="tag is-link">post</span></p><p class="subtitle is-uppercase"><i class="fas fa-clock"></i> <b class="has-text-link"> 3 min </b>READ</p></div></div><div class="content has-text-justified-desktop has-text-justified-fullhd has-text-justified has-text-justified-tablet has-text-left-mobile"><p><p>The Jib plugin is an open-source tool developed by Google that allows developers to build Docker images without needing Docker installed or writing a Dockerfile. It integrates directly with Maven and Gradle, creating Docker images by layering dependencies and resources efficiently. Jib also supports both local and remote builds, sending images directly to registries like Docker Hub, while producing slightly larger images compared to traditional methods.</p><hr /><div class="Article-Text"><span><h2>Jib plugin</h2><div>This is an open-source tool from Google that doesn't require Docker to work. You also don't need to write a Dockerfile.</div><div><br /></div><div>To use Jib, add the following to your pom.xml:</div><div><br /></div><pre style="font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 12px; line-height: 18px; font-family: Consolas, Monaco, Monospaced, monospace; margin-top: 5px; margin-bottom: 5px; padding: 5px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); max-width: 100%; overflow: auto; color: rgb(64, 64, 64);">
&lt;build&gt;
&nbsp; &nbsp; &lt;plugins&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &lt;plugin&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;groupid&gt;org.springframework.boot&lt;/groupid&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;artifactid&gt;spring-boot-maven-plugin&lt;/artifactid&gt;
&nbsp; &nbsp; &nbsp; &nbsp; &lt;/plugin&gt;
&nbsp; &nbsp; &lt;/plugins&gt;
&lt;/build&gt;
</pre><div><br /></div><h2>Building without Docker</h2><div>One of the advantages of this plugin is building without installing Docker:</div><div><br /></div><pre style="font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 12px; line-height: 18px; font-family: Consolas, Monaco, Monospaced, monospace; margin-top: 5px; margin-bottom: 5px; padding: 5px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); max-width: 100%; overflow: auto; color: rgb(64, 64, 64);">    mvn compile jib:build
</pre><div><br /></div><div>After the build, I searched for the image in my local storage. Then it hit me. In this mode, Docker is not used, so the image was sent to the registry on Docker Hub.</div><div>Pull the image and analyze it using dive:</div><div><br /></div><div> <img style="height: auto; display: block; margin: auto; max-width: 500px;" src="/assets/images/posts/2024/00009-1.jpg" /> <br /></div><div><br /></div><div>The final weight came out to be 321 MB, which is 12 megabytes more than the previous method. Among them:</div><div><br /></div><div> <img style="height: auto; display: block; margin: auto; max-width: 500px;" src="/assets/images/posts/2024/00009-2.jpg" /> <br /></div><div><br /></div><div><ul><li>78 + 48 MB - Linux and various certificates.</li><li>140 MB - JDK.</li><li>55 MB - layer with release dependencies.</li><li>14 KB - layer with snapshot dependencies.</li><li>981 bytes - only resources. Resources folder.</li><li>22 KB - our written code.</li></ul></div><div>Jib runs your image on behalf of the root user.</div><div>Similar to the Spring plugin, Jib separates dependencies into separate layers, but it goes even further and creates a separate layer for the resources folder. After all, resources are also rarely changed but can weigh a lot. For example, if you have many Liquibase migration scripts.</div><h2>Building using Docker</h2><div>For this, add the plugin as in the previous step but run a different command:</div><div><br /></div><pre style="font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 12px; line-height: 18px; font-family: Consolas, Monaco, Monospaced, monospace; margin-top: 5px; margin-bottom: 5px; padding: 5px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); max-width: 100%; overflow: auto; color: rgb(64, 64, 64);">    mvn compile jib:dockerBuild
</pre><div><br /></div><div>The size and structure of the layers are no different from the image we built without Docker.</div><h2>Conclusions on Jib</h2><div>If you have an ARM processor, the image will still be built for amd64.</div><div>I have never used this plugin in projects, only heard about it, so I can't make any deep conclusions. It surprised me that it can work without Docker; sometimes this can be useful. But I don't see the point in using it when there is a Spring plugin available.</div></span></div></p></div><div class="disqus-comments" id="disqus_thread"></div></div></div></section><footer id="footer"> <!--Footer Button--><div class="container has-text-centered has-background-grey-darker" id="backtotop"> <a class="has-text-white" onclick="window.scroll(0,0)">BACK TO TOP</a></div><!--Footer Main Section--><div class="has-background-grey-darker"><div class="container columns"> <!--Name Section--><div class="column has-text-left-desktop has-text-centered-mobile"> <a href="http://localhost:4000/#summary"><div class="columns"><div class="column is-one-fifth-desktop is-one-fifth-fullhd is-one-quarter-tablet"><figure class="image is-64x64"> <img class="is-rounded" src="/assets/images/logo.png"></figure></div><div class="column is-marginless"><h5 class="has-text-grey-lighter">Roman Surkoff</h5><div class="content has-text-grey"><p>🖖 Hey there! I am Roman Surkoff, an experienced software engineer</p></div></div></div></a></div><!--Link Section--><div class="column has-text-white"><h3>More Links</h3><li> <a href="http://localhost:4000/project">Projects</a></li><li> <a href="http://localhost:4000/tech-stack">Tech stack</a></li><li> <a target="_blank" href="http://localhost:4000/feed.xml">Subscribe via RSS</a></li></div><!--Blog-post Section--><div class="column has-text-white"><h3>Recent Posts</h3><li> <a href="http://localhost:4000/blog/deploying-keycloak-to-vps">Deploying Keycloak on a VPS Using Docker-compose, Nginx, Certbot, and SSL</a></li><li> <a href="http://localhost:4000/blog/optimal-docker-image-for-springboot-4">The optimal Docker image for Spring Boot. Part 4</a></li><li> <a href="http://localhost:4000/blog/optimal-docker-image-for-springboot-3">The optimal Docker image for Spring Boot. Part 3</a></li></div></div></div><div class="has-background-black has-text-centered has-text-white" id="credits"> <i class="far fa-copyright"></i> 2019 - 2024 by <a href="mailto:surkoff.com@gmail.com" target="_blank" >Roman Surkoff</a> | Powered by <a href="https://jekyllrb.com/" target="_blank" >Jekyll</a> | Based on <a href="https://github.com/thedevslot/WhatATheme" target="_blank" rel="noopener noreferrer" >TheDevsLot's WhatATheme</a></div></footer></body><script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://blog-surkoff-com.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script></html>
