<!DOCTYPE html><html><head><head> <!-- Include Meta Tags Here --><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta name="viewport" content="width=device-width, height=device-height, initial-scale=1 user-scalable=no, shrink-to-fit=no"><meta content='#000000' name='theme-color'/><meta name="keywords" content="Site, Blog, Portfolio, CV, Java, Engineer, Developer"><title>Roman Surkoff | Deploying Keycloak on a VPS Using Docker-compose, Nginx, Certbot, and SSL</title><!-- Open Graph general (Facebook, Pinterest & Google+) --><meta name="og:title" content="Roman Surkoff | Deploying Keycloak on a VPS Using Docker-compose, Nginx, Certbot, and SSL"><meta name="og:description" content="This article provides a step-by-step guide for deploying Keycloak on a VPS with Docker-compose, Nginx, Certbot, and SSL for secure access and automated deployment."><meta name="og:image" content="/assets/images/posts/2024/00012-0.jpeg"><meta name="og:image:alt" content="Roman Surkoff | Deploying Keycloak on a VPS Using Docker-compose, Nginx, Certbot, and SSL"><meta name="og:url" content="http://localhost:4000/blog/deploying-keycloak-to-vps"><meta name="article:author" content="https://www.facebook.com/"><meta name="og:site_name" content="Roman Surkoff | Deploying Keycloak on a VPS Using Docker-compose, Nginx, Certbot, and SSL"><meta name="og:type" content="website"> <!-- Twitter --><meta property="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Roman Surkoff | Deploying Keycloak on a VPS Using Docker-compose, Nginx, Certbot, and SSL"><meta name="twitter:description" content="This article provides a step-by-step guide for deploying Keycloak on a VPS with Docker-compose, Nginx, Certbot, and SSL for secure access and automated deployment."><meta name="twitter:site" content="@"><meta name="twitter:creator" content="@"><meta name="twitter:image:src" content="/assets/images/posts/2024/00012-0.jpeg"> <!-- Search Engine --><meta name="description" content="This article provides a step-by-step guide for deploying Keycloak on a VPS with Docker-compose, Nginx, Certbot, and SSL for secure access and automated deployment."><meta name="image" content="/assets/images/posts/2024/00012-0.jpeg"> <!-- Schema.org for Google --><meta itemprop="name" content="Roman Surkoff | Deploying Keycloak on a VPS Using Docker-compose, Nginx, Certbot, and SSL"><meta name="author" content="Roman Surkoff"/><meta itemprop="description" content="This article provides a step-by-step guide for deploying Keycloak on a VPS with Docker-compose, Nginx, Certbot, and SSL for secure access and automated deployment."><meta itemprop="image" content="/assets/images/posts/2024/00012-0.jpeg"> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=/"></script> <script> window.dataLayer = window.dataLayer || []; function gtag() { dataLayer.push(arguments); } gtag('js', new Date()); gtag('config', '/'); </script><title>Roman Surkoff</title><link rel="stylesheet" href="/assets/css/style.css"> <script src="https://kit.fontawesome.com/6a97161b76.js" crossorigin="anonymous"></script><link rel="shortcut icon" href="http://localhost:4000/assets/images/logo.png" type="image/x-icon"></head></head><body><nav class="navbar is-black is-fixed-top" role="navigation" aria-label="main navigation" id="navbar"><div class="container"> <!-- logo or branding image on left side --><div class="navbar-brand"> <a class="navbar-item" href="http://localhost:4000/"> <strong>Roman Surkoff</strong> </a><div class="navbar-burger" data-target="navbar-menu"> <span></span> <span></span> <span></span></div></div><!-- children of navbar-menu must be navbar-start and/or navbar-end --><div class="navbar-menu has-background-black" id="navbar-menu"> <!-- navbar items | left side --> <!--<div class="navbar-start"></div>--> <!-- navbar items | right side --><div class="navbar-end"> <a class="navbar-item " href="http://localhost:4000/">HOME</a> <a class="navbar-item" href="http://localhost:4000/#summary">SUMMARY</a> <a class="navbar-item" href="http://localhost:4000/#contact">CONTACT</a> <a class="navbar-item " href="http://localhost:4000/blog">BLOG</a><div class="navbar-item has-dropdown is-hoverable"> <a class="navbar-link"> MORE </a><div class="navbar-dropdown has-background-black is-left"> <a href="http://localhost:4000/about" class="navbar-item has-text-grey-light "> About me </a> <a href="http://localhost:4000/cv" class="navbar-item has-text-grey-light "> CV </a> <a href="http://localhost:4000/project" class="navbar-item has-text-grey-light "> Projects </a> <a href="http://localhost:4000/tech-stack" class="navbar-item has-text-grey-light "> Tech stack </a> <!--<hr class="navbar-divider"> <a class="navbar-item"> Report an issue </a> --></div></div></div></div></div></nav><!-- Bulma Navbar JS --> <script> document.addEventListener('DOMContentLoaded', function () { /* Get all "navbar-burger" elements */ var $navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0); /* Check if there are any navbar burgers */ if ($navbarBurgers.length > 0) { /* Add a click event on each of them */ $navbarBurgers.forEach(function ($el) { $el.addEventListener('click', function () { /* Get the target from the "data-target" attribute */ var target = $el.dataset.target; var $target = document.getElementById(target); /* Toggle the class on both the "navbar-burger" and the "navbar-menu" */ $el.classList.toggle('is-active'); $target.classList.toggle('is-active'); }); }); } }); </script><section class="hero is-fullheight has-text-centered" id="post"><div class="hero-body"><div class="container"> <a href="/blog/deploying-keycloak-to-vps" class="has-text-black" id="title"><h1 class="title has-text-centered is-2 has-text-weight-semibold">Deploying Keycloak on a VPS Using Docker-compose, Nginx, Certbot, and SSL</h1></a><hr class="has-background-black"><div class="columns is-variable is-5"><div class="column is-6"><figure class="image is-16by9 has-shadow"> <img src="/assets/images/posts/2024/00012-0.jpeg" alt="" id="post-image"></figure></div><div class="subtitle column is-5 has-text-left-desktop has-text-left-fullhd has-text-left-tablet has-text-center-mobile"><p id="description" class="content is-small has-text-weight-medium is-uppercase">This article provides a step-by-step guide for deploying Keycloak on a VPS with Docker-compose, Nginx, Certbot, and SSL for secure access and automated deployment.</p><p class="subtitle is-6 is-uppercase has-text-weight-normal has-text-black-ter">Published on <b>October 17, 2024</b> by <a href="`https://github.com/s-rb" target="_blank"><b class="has-text-link"><u>Roman Surkoff</u></b> </a></p><p class="subtitle is-uppercase"> <i class="fas fa-tags"></i> <span class="tag is-link">keycloak</span> <span class="tag is-link">docker</span> <span class="tag is-link">ssl</span> <span class="tag is-link">certbot</span> <span class="tag is-link">vps</span> <span class="tag is-link">nginx</span></p><p class="subtitle is-uppercase"><i class="fas fa-clock"></i> <b class="has-text-link"> 11 min </b>READ</p></div></div><div class="content has-text-justified-desktop has-text-justified-fullhd has-text-justified has-text-justified-tablet has-text-left-mobile"><p><p>The article explains how to deploy Keycloak, an open-source identity management system, on a VPS using Docker-compose, Nginx, Certbot, and SSL for secure access. It covers essential setup steps, including creating a domain, configuring Nginx, setting up SSL certificates, and using Docker for deployment automation. The guide also details how to handle automatic certificate renewal and import Keycloak realms during startup.</p><hr /><div class="Article-Text"><span><div>Hello everyone!</div><div><br /></div><div>In this article, I would like to share how to deploy Keycloak on a VPS using Docker-compose, Nginx, Certbot, and SSL.</div><div><br /></div><h2>Key Points:</h2><div>- Keycloak v.25.0.1</div><div>- SSL protection for Keycloak</div><div>- Certbot v.2.11.0 for obtaining and renewing SSL certificates</div><div>- Nginx v.1.27.0 as a reverse proxy</div><div>- Postgres v.14 to replace the default internal H2 DB of Keycloak</div><div>- Automatic realm import during deployment</div><div>- Docker-compose for deployment automation</div><div>- .env file for managing environment variables</div><div><br /></div><div>For those who might not be familiar, Keycloak is a powerful access management system with SSO support that can significantly simplify user management and authentication.</div><div><br /></div><div>The desire to deploy your own Keycloak can arise both for experimenting with your projects and for handling your usual backend tasks. This happened to me as well. I decided to kill two birds with one stone. However, I couldn't find a comprehensive guide. I don't need Keycloak locally, but setting it up on a separate, always-available server with backup and the ability to export/import realms, etc., is excellent. Plus, the deployment process is automated, making it easier to switch to another VPS provider.</div><div><br /></div><div>Everyone has their own motivation, but let's get to the point.</div><div><br /></div><h2>Introduction</h2><br /><h4>What is Keycloak?</h4><div>Keycloak is an open-source identity and access management solution. It provides features such as SSO (Single Sign-On), user management, authentication, and authorization.</div><br /><h4>Why Docker-compose?</h4><div>Docker-compose makes it easy to manage multi-component applications like Keycloak and simplifies the deployment and scaling process. This guide uses containers for Keycloak, Certbot, Nginx, and the Postgres database.</div><br /><h4>Why Nginx and Certbot?</h4><div>Nginx will act as a reverse proxy, ensuring security and performance, while Certbot will help obtain and automatically renew SSL certificates from Let's Encrypt, saving us a couple of thousand rubles on certificates for our domain, which is nice.</div><div><br /></div><div>Let's get started!</div><div><br /></div><h2>Step 1: Preparing the Environment</h2><h4>Cloning the Repository</h4><div>First, clone the repository with ready-made configurations to our VPS, which I have carefully prepared for you. It contains docker-compose.yml for managing deployment, nginx configs, and an environment variables file needed for docker-compose.</div><div><br /></div><pre style="font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 12px; line-height: 18px; font-family: Consolas, Monaco, Monospaced, monospace; margin-top: 5px; margin-bottom: 5px; padding: 5px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); max-width: 100%; overflow: auto; color: rgb(64, 64, 64);">    git clone git@github.com:s-rb/keycloak-dockerized-ssl-nginx.git
    cd keycloak-dockerized-ssl-nginx</pre><h4>Editing the .env File</h4><div>Open the .env file and edit the following variables:</div><div><br /></div><div>- <span style="font-weight: bold;">KEYCLOAK_ADMIN_PASSWORD</span> - Admin password for accessing Keycloak</div><div>- <span style="font-weight: bold;">KC_DB_PASSWORD</span> - Password for Keycloak service access to the Postgres DB (should match `POSTGRES_PASSWORD` if a separate user is not created)</div><div>- <span style="font-weight: bold;">POSTGRES_PASSWORD</span> - Admin password for Postgres</div><div><br /></div><div>Replace `password` with your values unless you want anyone to connect to your services ;)</div><div><br /></div><div>Example of a complete environment variables file:</div><div><br /></div><pre style="font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 12px; line-height: 18px; font-family: Consolas, Monaco, Monospaced, monospace; margin-top: 5px; margin-bottom: 5px; padding: 5px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); max-width: 100%; overflow: auto; color: rgb(64, 64, 64);">    KEYCLOAK_ADMIN=admin
    KEYCLOAK_ADMIN_PASSWORD=password
    PROXY_ADDRESS_FORWARDING=true
    KC_PROXY=edge
    <br />
    KC_DB=postgres
    KC_DB_URL=jdbc:postgresql://keycloak-postgres:5432/keycloak
    KC_DB_USERNAME=keycloak
    KC_DB_PASSWORD=password
    POSTGRES_DB=keycloak
    POSTGRES_USER=keycloak
    POSTGRES_PASSWORD=password
</pre><div><br /></div><h2>Step 2: Domain Registration and DNS Setup</h2><div>This step can be done before the first step - it does not depend on it. In the following instructions, we assume you have registered your domain (e.g., surkoff.com) and we want Keycloak to be accessible at my-keycloak.surkoff.com.</div><div><br /></div><h4>Domain Registration</h4><div>Register a domain with any registrar, for example, REG.RU.</div><div><br /></div><h4>Creating an A Record for the Subdomain</h4><div>Create an A record pointing to your server's IP. For example, for the subdomain my-keycloak.surkoff.com, specify your server's IP.</div><div><br /></div><div><img style="height: auto; display: block; margin: auto; max-width: 400px;" src="https://blog.surkoff.com/images/upload/154/642/3137/7B48E32F52CFD5C1EB1CC54C926D363A.jpg" /><br /></div><div><br /></div><h4>Checking the DNS Record</h4><div>Ensure the DNS record is correctly configured:</div><div><br /></div><div><pre style="margin-top: 5px; margin-bottom: 5px; padding: 5px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 12px; line-height: 18px; font-family: Consolas, Monaco, Monospaced, monospace; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; max-width: 100%; overflow: auto; color: rgb(64, 64, 64);">ping my-keycloak.surkoff.com</pre></div><div><br /></div><div>The response should show your server's IP address.</div><div><br /></div><h2>Step 3: Configuring Nginx</h2><h4>Nginx Configuration</h4><div>In the nginx configs - `<span style="font-weight: bold;">default.conf_with_ssl</span>`, `<span style="font-weight: bold;">default.conf_without_ssl</span>` specify your domain:</div><div><br /></div><div>- In the `<span style="font-weight: bold;">server_name</span>` section</div><div>- In the path to the certificate `<span style="font-weight: bold;">ssl_certificate</span>`</div><div>- In the path to the key `<span style="font-weight: bold;">ssl_certificate_key</span>`</div><div><br /></div><div>Example configuration with SSL:</div><div><div><pre style="margin-top: 5px; margin-bottom: 5px; padding: 5px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 12px; line-height: 18px; font-family: Consolas, Monaco, Monospaced, monospace; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; max-width: 100%; overflow: auto; color: rgb(64, 64, 64);">server {
    listen 443 ssl;
    server_name my-keycloak.surkoff.com;

    ssl_certificate /etc/letsencrypt/live/my-keycloak.surkoff.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/my-keycloak.surkoff.com/privkey.pem;

    location / {
        proxy_pass http://keycloak:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}</pre></div><div><br /></div></div><h2>Step 4: Obtaining an SSL Certificate</h2><h4>Obtaining a Test Certificate</h4><div>Use the configuration without SSL:</div><div><div><pre style="margin-top: 5px; margin-bottom: 5px; padding: 5px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: 18px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; max-width: 100%; overflow: auto;"><span style="color: rgb(64, 64, 64); font-family: Consolas, Monaco, Monospaced, monospace; font-size: 12px;">cp nginx/conf.d/default.conf_without_ssl nginx/conf.d/default.conf
docker-compose up -d</span></pre></div><div><br /></div><div>Obtain a test certificate (replace the domain and email with your own):</div></div><div><pre style="margin-top: 5px; margin-bottom: 5px; padding: 5px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: 18px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; max-width: 100%; overflow: auto;"><span style="color: rgb(64, 64, 64); font-family: Consolas, Monaco, Monospaced, monospace; font-size: 12px;">docker exec certbot certbot certonly --webroot --webroot-path=/data/letsencrypt -d my-keycloak.surkoff.com --email your_email@gmail.com --agree-tos --no-eff-email --staging</span></pre></div><h4><img style="height: auto; display: block; margin: auto; max-width: 750px;" src="https://blog.surkoff.com/images/upload/-20/797/64064/784819F1E978B245B694B7749D3F054D.jpg" /><br /></h4><h4>Checking the Certificate</h4><div><pre style="margin-top: 5px; margin-bottom: 5px; padding: 5px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: 18px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; max-width: 100%; overflow: auto;"><span style="color: rgb(64, 64, 64); font-family: Consolas, Monaco, Monospaced, monospace; font-size: 12px;">docker exec certbot certbot certificates</span></pre></div><br /><h4>Deleting the Test Certificate (replace the domain with your own)</h4><div><pre style="margin-top: 5px; margin-bottom: 5px; padding: 5px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: 18px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; max-width: 100%; overflow: auto;"><span style="color: rgb(64, 64, 64); font-family: Consolas, Monaco, Monospaced, monospace; font-size: 12px;">docker exec certbot certbot delete --cert-name my-keycloak.surkoff.com</span></pre></div><br /><h4>Obtaining a Real Certificate (replace email and domain with your own)</h4><div><pre style="margin-top: 5px; margin-bottom: 5px; padding: 5px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: 18px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; max-width: 100%; overflow: auto;"><span style="color: rgb(64, 64, 64); font-family: Consolas, Monaco, Monospaced, monospace; font-size: 12px;">docker exec certbot certbot certonly --webroot --webroot-path=/data/letsencrypt -d my-keycloak.surkoff.com --email your_email@gmail.com --agree-tos --no-eff-email</span></pre></div><br /><h2>Step 5: Final Configuration and Launch</h2><h4>Updating Nginx Configuration to Use SSL</h4><div><pre style="margin-top: 5px; margin-bottom: 5px; padding: 5px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: 18px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; max-width: 100%; overflow: auto;"><span style="color: rgb(64, 64, 64); font-family: Consolas, Monaco, Monospaced, monospace; font-size: 12px;">docker-compose down
cp nginx/conf.d/default.conf_with_ssl nginx/conf.d/default.conf
docker-compose up -d</span></pre></div><br /><h4>Checking Access to Keycloak</h4><div>Open a browser and go to my-keycloak.surkoff.com (your domain).</div><div><br /></div><div>You should see the admin login page where you can log in using the username and password you specified in the .env file.</div><div><br /></div><div><img style="height: auto; display: block; margin: auto; max-width: 750px;" src="https://blog.surkoff.com/images/upload/-74/563/0311/DF270E9D92F17ACD5F10830A80BAC89E.jpg" /><br /></div><div><br /></div><div>For configuring Keycloak, there are interesting articles on other resources, which we won't cover in this publication.</div><div><br /></div><h4>Automatic Certificate Renewal</h4><div>To automatically renew certificates and restart Nginx, create the `renew_and_reload.sh` script (already available in the repository):</div><div><div><pre style="margin-top: 5px; margin-bottom: 5px; padding: 5px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: 18px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; max-width: 100%; overflow: auto;"><span style="color: rgb(64, 64, 64); font-family: Consolas, Monaco, Monospaced, monospace; font-size: 12px;">#!/bin/bash
# Renew certificates
docker exec certbot certbot renew --webroot --webroot-path=/data/letsencrypt

# Restart Nginx
docker restart nginx</span></pre></div></div><div><br /></div><div>Make the script executable:</div><div><div><pre style="margin-top: 5px; margin-bottom: 5px; padding: 5px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: 18px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; max-width: 100%; overflow: auto;"><span style="color: rgb(64, 64, 64); font-family: Consolas, Monaco, Monospaced, monospace; font-size: 12px;">chmod +x renew_and_reload.sh</span></pre></div></div><div><br /></div><div>Add it to crontab for regular execution:</div><div><div><pre style="margin-top: 5px; margin-bottom: 5px; padding: 5px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: 18px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; max-width: 100%; overflow: auto;"><span style="color: rgb(64, 64, 64); font-family: Consolas, Monaco, Monospaced, monospace; font-size: 12px;">crontab -e</span></pre></div></div><div><br /></div><div>Add a line to crontab, remembering to specify the path to the script:</div><div><pre style="margin-top: 5px; margin-bottom: 5px; padding: 5px; background-image: none; background-position: 0px 0px; background-repeat: repeat; background-attachment: scroll; background-color: rgb(241, 241, 241); font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: 18px; vertical-align: baseline; border: 1px solid rgb(154, 154, 154); outline: 0px; max-width: 100%; overflow: auto;"><span style="color: rgb(64, 64, 64); font-family: Consolas, Monaco, Monospaced, monospace; font-size: 12px;">0 0 1 * * /path/to/renew_and_reload.sh</span></pre></div><br /><h2>Importing Realms</h2><div>If you want to import a realm at startup, you can place it in the `<span style="font-weight: bold;">keycloak/config/</span>` folder, and it will be imported when the application starts.</div><div><br /></div><h2>Conclusion</h2><div>That's it! Now you have a deployed latest&nbsp;<span style="font-weight: bold;">Keycloak</span> with <span style="font-weight: bold;">SSL</span> on your <span style="font-weight: bold;">VPS</span>. I hope this article was helpful! If you have any questions or suggestions, feel free to write to me in private messages.</div><div><br /></div><div>The source code is available at the link - <a href="https://github.com/s-rb/keycloak-dockerized-ssl-nginx">https://github.com/s-rb/keycloak-dockerized-ssl-nginx</a>.</div></span></div></p></div><div class="disqus-comments" id="disqus_thread"></div></div></div></section><footer id="footer"> <!--Footer Button--><div class="container has-text-centered has-background-grey-darker" id="backtotop"> <a class="has-text-white" onclick="window.scroll(0,0)">BACK TO TOP</a></div><!--Footer Main Section--><div class="has-background-grey-darker"><div class="container columns"> <!--Name Section--><div class="column has-text-left-desktop has-text-centered-mobile"> <a href="http://localhost:4000/#summary"><div class="columns"><div class="column is-one-fifth-desktop is-one-fifth-fullhd is-one-quarter-tablet"><figure class="image is-64x64"> <img class="is-rounded" src="/assets/images/logo.png"></figure></div><div class="column is-marginless"><h5 class="has-text-grey-lighter">Roman Surkoff</h5><div class="content has-text-grey"><p>🖖 Hey there! I am Roman Surkoff, an experienced software engineer</p></div></div></div></a></div><!--Link Section--><div class="column has-text-white"><h3>More Links</h3><li> <a href="http://localhost:4000/project">Projects</a></li><li> <a href="http://localhost:4000/tech-stack">Tech stack</a></li><li> <a target="_blank" href="http://localhost:4000/feed.xml">Subscribe via RSS</a></li></div><!--Blog-post Section--><div class="column has-text-white"><h3>Recent Posts</h3><li> <a href="http://localhost:4000/blog/deploying-keycloak-to-vps">Deploying Keycloak on a VPS Using Docker-compose, Nginx, Certbot, and SSL</a></li><li> <a href="http://localhost:4000/blog/optimal-docker-image-for-springboot-4">The optimal Docker image for Spring Boot. Part 4</a></li><li> <a href="http://localhost:4000/blog/optimal-docker-image-for-springboot-3">The optimal Docker image for Spring Boot. Part 3</a></li></div></div></div><div class="has-background-black has-text-centered has-text-white" id="credits"> <i class="far fa-copyright"></i> 2019 - 2024 by <a href="mailto:surkoff.com@gmail.com" target="_blank" >Roman Surkoff</a> | Powered by <a href="https://jekyllrb.com/" target="_blank" >Jekyll</a> | Based on <a href="https://github.com/thedevslot/WhatATheme" target="_blank" rel="noopener noreferrer" >TheDevsLot's WhatATheme</a></div></footer></body><script> /** * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS. * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/ /* var disqus_config = function () { this.page.url = PAGE_URL; Replace PAGE_URL with your page's canonical URL variable this.page.identifier = PAGE_IDENTIFIER; Replace PAGE_IDENTIFIER with your page's unique identifier variable }; */ (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://blog-surkoff-com.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script></html>
